@{
    ViewData["Title"] = "Subir Archivos de Productos";
}

<div class="card">
    <div class="card-header">
        Cargar Archivos de Productos
    </div>
    <div class="card-body">
        <div asp-validation-summary="All" class="text-danger"></div>
        <form asp-action="SubirProductos" method="post" enctype="multipart/form-data">
            <div class="file-upload-wrapper">
                <div class="file-upload-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" class="bi bi-box-seam" viewBox="0 0 16 16">
                        <path d="M8.186 1.113a.5.5 0 0 0-.372 0L1.846 3.5l2.404.961L8 2.596l3.75 1.865 2.404-.961L8.186 1.113zM14.5 3.5l-2.404.961L8 6.404 4.25 4.46l-2.404-.961L1.5 3.5v9l6.5 3 6.5-3v-9zM1 3.76l7 2.8v8.64l-7-2.8V3.76zm14 0v8.64l-7 2.8v-8.64l7-2.8z"/>
                    </svg>
                </div>
                <label for="archivosExcel" class="file-upload-label">
                    Arrastra tus archivos de productos aqu√≠ o haz clic para seleccionar
                </label>
                <input type="file" name="archivosExcel" id="archivosExcel" multiple accept=".xls,.xlsx" />
            </div>
            <div id="file-name-display" class="text-center"></div>
            <div class="btn-container">
                <button type="submit" class="btn-primary">Procesar Productos</button>
            </div>
        </form>
    </div>
</div>

@if (ViewData["MensajeExito"] != null)
{
    <div class="alert alert-success mt-4" role="alert">
        @ViewData["MensajeExito"]
    </div>
}

@section Scripts {
    <script>
        document.getElementById('archivosExcel').addEventListener('change', function(e) {
            const fileInput = e.target;
            const display = document.getElementById('file-name-display');

            if (fileInput.files && fileInput.files.length > 0) {
                if (fileInput.files.length === 1) {
                    display.textContent = 'Archivo seleccionado: ' + fileInput.files[0].name;
                } else {
                    display.textContent = fileInput.files.length + ' archivos seleccionados';
                }
            } else {
                display.textContent = '';
            }
        });
    </script>
}
